<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
  font: 10px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.line {
  fill: none;
  stroke-width: 1.5px;
}

.tooltip .circle{
  fill: none;
}
</style>
<body>
  <div id="controls">
  	<label for="amplitude">Amplitude:</label>
  	<input id="amplitude" type="number" min="0" max="100" step="5" onchange="generator.amplitude(parseInt(this.value));" />

  	<label for="growth">Growth:</label>
  	<input id="growth" type="number" onchange="generator.growth(parseInt(this.value));" />



  	<button onclick="update();">Update</button>
  </div>
  <div id="line-1" width="900px" height="200px" style="display: inline-block;"></div>
  <div id="bar-1" width="400px" height="200px" style="display: inline-block;"></div>
  <div id="donut-1"></div>
  <table>
  	<thead>
	  	<tr>
	  		<th rowspan="2">Run</th>
	  		<th rowspan="2">Min</th>
	  		<th rowspan="2">Max</th>
	  		<th colspan="2">Quartiles</th>
	  		<th rowspan="2">Mean</th>
	  		<th rowspan="2">Deviation</th>
	  		<th rowspan="2">Varience</th>
	  		<th rowspan="2">Amplitude</th>
	  		<th rowspan="2">Growth</th>
	  		<th rowspan="2">Days</th>
	  		<th colspan="4">Bands</th>
	  	</tr>
	  	<tr>
	  		<th>Lower</th>
	  		<th>Upper</th>
	  		<th>Low</th>
	  		<th>Medium</th>
	  		<th>High</th>
	  		<th>Critical</th>
	  	</tr>
	  </thead>
	  <tbody>
	  </tbody>
	</table>
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
<script src="http://d3js.org/d3.v3.js"></script>
<script src="d3.line.js"></script>
<script src="d3.bar.js"></script>
<script src="d3.donut.js"></script>
<script src="generator.js"></script>

<script>

// Method used for generate random data.
var getData = function(myRand){
  var data = [];
  
  for(var i=0; i<100; i++){
  	var point = Math.round(myRand());
  	if(point > 100){
  		point = 100;
  	}else if(point < 0){
  		point = 0;
  	}
    data.push({
      x: i,
      y: point
    });
  };

  return data;
};

/*
* Create graphs
*/
var days = 28;
var generator = generator().days(days);
var data = generator.calculate();
var run = 0;

var line = line()
	.$el(d3.select("#line-1"))
	.height(200) // Set height
	.width(900)
	.data(data) // Set data
	.render();
var bar = bar()
	.$el(d3.select("#bar-1"))
	.data(generator.bands())
	.width(400)
	.color(["green", "blue", "orange", "red"])
	.labelColor(["black", "white", "black", "black"])
	// .mouseOver(function(d){ alert(d.value); })
	.render();

appendTable(generator.stats());
// var donut = donut()
// 	.$el(d3.select("#donut-1"))
// 	.data(bandIt(data))
// 	.color(["green", "blue", "orange", "red"])
// 	.render();

function update(){
	data = generator.calculate();

	appendTable(generator.stats());

	line.data(data).render();
	bar.data(generator.bands()).render();
	// donut.data(bandedData).render();
};

function appendTable(data){
	var output = "<tr><td>" + run + "</td>";
	run++;
	$.each(data, function(key, value){
		if($.isPlainObject(value)){
			$.each(value, function(key, value){
				output += "<td>";
				output += value;
				output += "</td>";	
			})
		}else{
			output += "<td>";
			output += value;
			output += "</td>";
		}
	})
	output += "</tr>";
	$("tbody").prepend(output);
};

// setInterval(function(){
// 	var data = generator().days(days).calculate();
// 	var bandedData = bandIt(data);

// 	line.data(data).render();
// 	bar.data(bandedData).render();
// 	donut.data(bandedData).render();
// }, 3000);
</script>
</html>